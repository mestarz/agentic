# ContextFabric (Agentic)

ContextFabric 是一个专业的 LLM 上下文治理中间件与交互式 Agent 开发平台。它采用物理上彻底解耦的架构，将复杂的上下文压缩、历史治理逻辑与应用端的对话流控分离，为生产级 Agent 提供坚实的基础设施。

## 🌟 核心特性

- **彻底解耦架构**：通过 `Core`（引擎）与 `Agent`（网关）双服务模式，实现上下文治理逻辑与对话业务逻辑的完全隔离。
- **精准 Token 治理**：集成 `tiktoken-go`，支持对长文本、中英混合内容的精准计数与智能滑动窗口截断。
- **可靠的流式传输**：采用结构化 JSON 编码的 SSE 协议，解决传统 SSE 在换行符和特殊字符传输中的不稳定性。
- **交互式时序观察器**：内置基于 SVG 的交互式时序图，直观展示前端、Agent、Core 与 LLM 之间的实时通信轨迹。
- **专业级 UI**：全中文界面，支持 Markdown 渲染、代码高亮、单条及批量会话管理。
- **无痕安全设计**：API Keys 仅在浏览器 LocalStorage 与服务端内存中流转，不进行任何磁盘持久化。

## 🏗️ 系统架构

### 后端 (Go)
- **Core Service (端口 9091)**: 负责会话持久化、上下文优化、Token 计算（cl100k_base）及会话清理。
- **Agent Service (端口 9090)**: 负责模型适配（Gemini, DeepSeek, OpenAI 等）、协议转换及 Pipeline 轨迹生成。

### 前端 (TypeScript + React)
- 基于 Vite + TailwindCSS 构建的调试控制台。
- 具备 Inspector 详情面板，支持深度报文洞察。

## 🚀 快速上手

### 环境要求
- Go 1.21+
- Node.js 18+
- NPM 或 Yarn

### 安装与构建
```bash
# 克隆仓库
git clone <repo-url>
cd agentic

# 构建后端
cd backend
go mod tidy
go build -o ../bin/cf-core ./core/main.go
go build -o ../bin/cf-agent ./agent/main.go

# 构建前端
cd ../frontend
npm install
npm run build
```

### 运行
你可以直接使用根目录下的脚本进行一键启停：
```bash
./start.sh  # 启动 Core, Agent 和预览服务
./stop.sh   # 停止所有相关进程
```
启动后访问 `http://localhost:5173`（或脚本输出的地址）即可进入控制台。

## 📂 目录结构

```text
.
├── backend/
│   ├── core/           # 上下文治理引擎
│   └── agent/          # 模型适配与交互网关
├── frontend/           # React 调试控制台
├── bin/                # 编译产物
├── data/               # 会话历史存储 (JSON)
├── DESIGN.md           # 详细设计文档
└── IMPLEMENTATION_DETAIL.md # 技术实现细节
```

## 📜 接口文档
项目内置了详尽的 API 文档，启动后可在 Web 界面的“接口文档”栏目中查看 Core 服务提供的所有核心端点。

---
*Generated by Gemini Agentic Environment.*
